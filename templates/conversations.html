<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conversation Logs - EduChat Admin Portal</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="{{ url_for('static', filename='assets/css/style.css') }}" rel="stylesheet">
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h3>EduChat Admin</h3>
            </div>
            <nav class="sidebar-nav">
    <ul>
        <li class="{% if active_page == 'dashboard' %}active{% endif %}">
            <a href="{{ url_for('dashboard') }}"><i class="fas fa-th-large"></i> Dashboard</a>
        </li>
        
        <li class="section-header">USER MANAGEMENT</li>
        <li class="{% if active_page == 'users' %}active{% endif %}">
            <a href="{{ url_for('users') }}"><i class="fas fa-users"></i> User Accounts</a>
        </li>
        <li class="{% if active_page == 'roles' %}active{% endif %}">
            <a href="{{ url_for('roles') }}"><i class="fas fa-user-shield"></i> Roles & Permissions</a>
        </li>
        
        <li class="section-header">CHATBOT MANAGEMENT</li>
        <li class="{% if active_page == 'conversations' %}active{% endif %}">
            <a href="{{ url_for('conversations') }}"><i class="fas fa-comments"></i> Conversation Logs</a>
        </li>
        <li class="{% if active_page == 'faq' %}active{% endif %}">
            <a href="{{ url_for('faq') }}"><i class="fas fa-question-circle"></i> FAQ Management</a>
        </li>
        <li class="{% if active_page == 'settings' %}active{% endif %}">
            <a href="{{ url_for('settings') }}"><i class="fas fa-cog"></i> Bot Settings</a>
        </li>
        
        <li class="section-header">ANALYTICS</li>
        <li class="{% if active_page == 'usage' %}active{% endif %}">
            <a href="{{ url_for('usage') }}"><i class="fas fa-chart-bar"></i> Usage Statistics</a>
        </li>
        <li class="{% if active_page == 'feedback' %}active{% endif %}">
            <a href="{{ url_for('feedback') }}"><i class="fas fa-heart"></i> User Feedback</a>
        </li>
    </ul>
</nav>

            
            <!-- User Profile at Bottom -->
            <div class="sidebar-user-profile">
                <div class="user-avatar">A</div>
                <div class="user-details">
                    <div class="user-name">Admin User</div>
                    <div class="user-role">Super Administrator</div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="header">
                <div class="header-left">
                    <div class="search-bar">
                        <i class="fas fa-search"></i>
                        <input type="text" placeholder="Search conversations" class="search-input" data-search-type="conversations">
                    </div>
                </div>
                <div class="header-right">
                    <div class="notification-icon">
                        <i class="fas fa-bell"></i>
                        <span class="notification-badge">3</span>
                    </div>
                    <div class="user-info">
                        <div class="user-avatar">A</div>
                        <div class="user-details">
                            <div class="user-name">Admin User</div>
                            <div class="user-role">Super Administrator</div>
                        </div>
                    </div>
                    <div class="logout-icon" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i>
                    </div>
                </div>
            </header>

            <!-- Page Content -->
            <div class="page-content">
                <div class="page-header">
                    <div>
                        <h1 class="page-title">Conversation Logs</h1>
                        <p class="page-subtitle">Monitor and analyze chatbot conversations</p>
                    </div>
                    <div class="header-actions">
                        <button class="btn btn-outline-primary" onclick="exportConversations()">
                            <i class="fas fa-download"></i>
                            Export
                        </button>
                        <button class="btn btn-primary" onclick="showFilters()">
                            <i class="fas fa-filter"></i>
                            Filters
                        </button>
                    </div>
                </div>

                <!-- Filters Section -->
                <div class="filters-section" id="filters-section" style="display: none;">
                    <div class="card">
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label>Date Range</label>
                                        <select class="form-control" id="date-range">
                                            <option value="today">Today</option>
                                            <option value="week">This Week</option>
                                            <option value="month" selected>This Month</option>
                                            <option value="quarter">This Quarter</option>
                                            <option value="year">This Year</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label>Sentiment</label>
                                        <select class="form-control" id="sentiment-filter">
                                            <option value="">All Sentiments</option>
                                            <option value="positive">Positive</option>
                                            <option value="neutral">Neutral</option>
                                            <option value="negative">Negative</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label>User Type</label>
                                        <select class="form-control" id="user-type">
                                            <option value="">All Users</option>
                                            <option value="student">Students</option>
                                            <option value="faculty">Faculty</option>
                                            <option value="staff">Staff</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label>Status</label>
                                        <select class="form-control" id="status-filter">
                                            <option value="">All Status</option>
                                            <option value="resolved">Resolved</option>
                                            <option value="pending">Pending</option>
                                            <option value="escalated">Escalated</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="filter-actions">
                                <button class="btn btn-primary" onclick="applyFilters()">Apply Filters</button>
                                <button class="btn btn-secondary" onclick="clearFilters()">Clear All</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Conversations Table -->
                <div class="table-container">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>User</th>
                                <th>Message</th>
                                <th>Response</th>
                                <th>Sentiment</th>
                                <th>Status</th>
                                <th>Date</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="conversations-table-body">
                            <!-- Conversations will be populated here -->
                        </tbody>
                    </table>
                </div>

                <!-- Pagination -->
                <div class="pagination-container">
                    <div class="pagination-info">
                        Showing <span id="start-item">1</span> to <span id="end-item">10</span> of <span id="total-items">0</span> conversations
                    </div>
                    <div class="pagination-controls">
                        <button class="btn btn-outline-secondary" onclick="previousPage()" id="prev-btn">
                            <i class="fas fa-chevron-left"></i>
                            Previous
                        </button>
                        <div class="page-numbers">
                            <button class="btn btn-outline-primary active">1</button>
                            <button class="btn btn-outline-secondary">2</button>
                            <button class="btn btn-outline-secondary">3</button>
                        </div>
                        <button class="btn btn-outline-secondary" onclick="nextPage()" id="next-btn">
                            Next
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Conversation Detail Modal -->
    <div class="modal" id="conversation-detail-modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h4>Conversation Detail</h4>
                <button class="btn-close" onclick="closeModal('conversation-detail-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="conversation-detail">
                    <div class="conversation-header">
                        <div class="user-info">
                            <div class="user-avatar">J</div>
                            <div class="user-details">
                                <div class="user-name">John Doe</div>
                                <div class="user-email">john.doe@university.edu</div>
                            </div>
                        </div>
                        <div class="conversation-meta">
                            <span class="sentiment-badge positive">Positive</span>
                            <span class="status-badge resolved">Resolved</span>
                        </div>
                    </div>
                    <div class="conversation-messages" id="conversation-messages">
                        <!-- Messages will be populated here -->
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('conversation-detail-modal')">Close</button>
                <button class="btn btn-primary" onclick="escalateConversation()">Escalate</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="{{ url_for('static', filename='assets/js/core/BaseManager.js') }}"></script>
    <script src="{{ url_for('static', filename='assets/js/modules/AuthManager.js') }}"></script>
    <script src="{{ url_for('static', filename='assets/js/modules/ConversationManager.js') }}"></script>
    <script src="{{ url_for('static', filename='assets/js/utils/toast.js') }}"></script>
    <script src="{{ url_for('static', filename='assets/js/app.js') }}"></script>

    <script>
        // Updated JavaScript for conversations.html to work with MongoDB backend
// This replaces the script section in your conversations.html file

let conversationManager;
let currentPage = 1;
let itemsPerPage = 10;
let currentFilters = {};
let totalPages = 1;

document.addEventListener('DOMContentLoaded', function() {
    const authManager = new AuthManager();
    if (!authManager.checkAuth()) {
        window.location.href = '../index.html';
        return;
    }

    conversationManager = new ConversationManager();
    loadConversations();
    setupEventListeners();
    
    // Check if we need to initialize sample data
    checkAndInitializeSampleData();
});

function setupEventListeners() {
    // Search functionality with debouncing
    const searchInput = document.querySelector('.search-input');
    let searchTimeout;
    
    searchInput.addEventListener('input', function() {
        clearTimeout(searchTimeout);
        const query = this.value.trim();
        
        searchTimeout = setTimeout(() => {
            if (query) {
                currentFilters.search = query;
                currentPage = 1; // Reset to first page
                loadConversations();
            } else {
                delete currentFilters.search;
                loadConversations();
            }
        }, 500); // 500ms debounce
    });

    // Filter change events
    document.getElementById('date-range').addEventListener('change', applyFilters);
    document.getElementById('sentiment-filter').addEventListener('change', applyFilters);
    document.getElementById('user-type').addEventListener('change', applyFilters);
    document.getElementById('status-filter').addEventListener('change', applyFilters);
}

async function loadConversations() {
    try {
        showLoadingState();
        
        const options = {
            page: currentPage,
            per_page: itemsPerPage,
            ...currentFilters
        };

        const response = await conversationManager.getAll(options);
        
        if (response.success) {
            renderConversations(response.conversations);
            updatePagination(response.pagination);
        } else {
            throw new Error(response.message || 'Failed to load conversations');
        }
    } catch (error) {
        console.error('Error loading conversations:', error);
        toast.error('Failed to load conversations: ' + error.message);
        renderConversations([]); // Show empty state
    } finally {
        hideLoadingState();
    }
}

function renderConversations(conversations) {
    const tbody = document.getElementById('conversations-table-body');
    tbody.innerHTML = '';

    if (conversations.length === 0) {
        tbody.innerHTML = `
            <tr>
                <td colspan="7" class="text-center py-4">
                    <div class="empty-state">
                        <i class="fas fa-comments fa-3x mb-3 text-muted"></i>
                        <h5>No conversations found</h5>
                        <p class="text-muted">Try adjusting your filters or search terms.</p>
                    </div>
                </td>
            </tr>
        `;
        return;
    }

    conversations.forEach(conversation => {
        const row = document.createElement('tr');
        const timestamp = new Date(conversation.timestamp);
        
        row.innerHTML = `
            <td>
                <div class="user-info-cell">
                    <div class="user-avatar">${conversation.user.name.charAt(0).toUpperCase()}</div>
                    <div class="user-details">
                        <div class="user-name">${escapeHtml(conversation.user.name)}</div>
                        <div class="user-email">${escapeHtml(conversation.user.email)}</div>
                    </div>
                </div>
            </td>
            <td>
                <div class="message-preview" title="${escapeHtml(conversation.message)}">
                    <strong>${escapeHtml(truncateText(conversation.message, 50))}</strong>
                </div>
            </td>
            <td>
                <div class="response-preview" title="${escapeHtml(conversation.response)}">
                    ${escapeHtml(truncateText(conversation.response, 50))}
                </div>
            </td>
            <td>
                <span class="sentiment-badge ${conversation.sentiment.toLowerCase()}">${conversation.sentiment}</span>
            </td>
            <td>
                <span class="status-badge ${conversation.status.toLowerCase()}">${conversation.status}</span>
            </td>
            <td>
                <div class="date-info">
                    <div class="date">${timestamp.toLocaleDateString()}</div>
                    <div class="time">${timestamp.toLocaleTimeString()}</div>
                </div>
            </td>
            <td>
                <div class="action-buttons">
                    <button class="btn btn-sm btn-outline-primary" onclick="viewConversation('${conversation._id}')" title="View">
                        <i class="fas fa-eye"></i>
                    </button>
                    ${conversation.status !== 'Escalated' ? `
                        <button class="btn btn-sm btn-outline-warning" onclick="escalateConversation('${conversation._id}')" title="Escalate">
                            <i class="fas fa-flag"></i>
                        </button>
                    ` : ''}
                    <button class="btn btn-sm btn-outline-success" onclick="editConversation('${conversation._id}')" title="Edit">
                        <i class="fas fa-edit"></i>
                    </button>
                </div>
            </td>
        `;
        tbody.appendChild(row);
    });
}

function showFilters() {
    const filtersSection = document.getElementById('filters-section');
    const isVisible = filtersSection.style.display !== 'none';
    filtersSection.style.display = isVisible ? 'none' : 'block';
    
    // Update button text
    const filterBtn = document.querySelector('[onclick="showFilters()"]');
    filterBtn.innerHTML = isVisible ? 
        '<i class="fas fa-filter"></i> Filters' : 
        '<i class="fas fa-filter-circle-xmark"></i> Hide Filters';
}

async function applyFilters() {
    const dateRange = document.getElementById('date-range').value;
    const sentiment = document.getElementById('sentiment-filter').value;
    const userType = document.getElementById('user-type').value;
    const status = document.getElementById('status-filter').value;

    currentFilters = {};
    
    if (dateRange) currentFilters.date_range = dateRange;
    if (sentiment) currentFilters.sentiment = sentiment;
    if (userType) currentFilters.user_type = userType;
    if (status) currentFilters.status = status;
    
    currentPage = 1; // Reset to first page when applying filters
    await loadConversations();
}

function clearFilters() {
    document.getElementById('date-range').value = '';
    document.getElementById('sentiment-filter').value = '';
    document.getElementById('user-type').value = '';
    document.getElementById('status-filter').value = '';
    
    // Clear search input
    document.querySelector('.search-input').value = '';
    
    currentFilters = {};
    currentPage = 1;
    loadConversations();
}

async function viewConversation(id) {
    try {
        const conversation = await conversationManager.getById(id);
        if (!conversation) {
            toast.error('Conversation not found');
            return;
        }

        // Populate conversation detail modal
        const modal = document.getElementById('conversation-detail-modal');
        const messagesContainer = document.getElementById('conversation-messages');
        
        // Update user info
        modal.querySelector('.user-name').textContent = conversation.user.name;
        modal.querySelector('.user-email').textContent = conversation.user.email;
        modal.querySelector('.user-avatar').textContent = conversation.user.name.charAt(0).toUpperCase();
        
        // Update sentiment and status badges
        const sentimentBadge = modal.querySelector('.sentiment-badge');
        sentimentBadge.textContent = conversation.sentiment;
        sentimentBadge.className = `sentiment-badge ${conversation.sentiment.toLowerCase()}`;
        
        const statusBadge = modal.querySelector('.status-badge');
        statusBadge.textContent = conversation.status;
        statusBadge.className = `status-badge ${conversation.status.toLowerCase()}`;

        // Render conversation messages
        const timestamp = new Date(conversation.timestamp);
        messagesContainer.innerHTML = `
            <div class="message user-message">
                <div class="message-content">
                    <div class="message-text">${escapeHtml(conversation.message)}</div>
                    <div class="message-time">${timestamp.toLocaleString()}</div>
                </div>
            </div>
            <div class="message bot-message">
                <div class="message-content">
                    <div class="message-text">${escapeHtml(conversation.response)}</div>
                    <div class="message-time">${new Date(timestamp.getTime() + 5000).toLocaleString()}</div>
                </div>
            </div>
        `;

        // Store current conversation ID for modal actions
        modal.dataset.conversationId = id;
        modal.style.display = 'flex';
    } catch (error) {
        console.error('Error viewing conversation:', error);
        toast.error('Failed to load conversation details');
    }
}

async function escalateConversation(id) {
    if (!confirm('Are you sure you want to escalate this conversation?')) {
        return;
    }

    try {
        const result = await conversationManager.escalateConversation(id);
        if (result.success) {
            await loadConversations(); // Reload to show updated status
        }
    } catch (error) {
        console.error('Error escalating conversation:', error);
        // Toast error already shown by ConversationManager
    }
}

async function editConversation(id) {
    try {
        const conversation = await conversationManager.getById(id);
        if (!conversation) {
            toast.error('Conversation not found');
            return;
        }

        // Show edit modal (you would need to create this modal)
        showEditModal(conversation);
    } catch (error) {
        console.error('Error loading conversation for edit:', error);
        toast.error('Failed to load conversation for editing');
    }
}

async function exportConversations() {
    try {
        await conversationManager.downloadCSV(currentFilters);
    } catch (error) {
        console.error('Error exporting conversations:', error);
        // Toast error already shown by ConversationManager
    }
}

function updatePagination(pagination) {
    const { page, per_page, total, pages } = pagination;
    
    // Update pagination info
    const startItem = total === 0 ? 0 : (page - 1) * per_page + 1;
    const endItem = Math.min(page * per_page, total);
    
    document.getElementById('start-item').textContent = startItem;
    document.getElementById('end-item').textContent = endItem;
    document.getElementById('total-items').textContent = total;
    
    // Update current page and total pages
    currentPage = page;
    totalPages = pages;
    
    // Update button states
    const prevBtn = document.getElementById('prev-btn');
    const nextBtn = document.getElementById('next-btn');
    
    prevBtn.disabled = page <= 1;
    nextBtn.disabled = page >= pages;
    
    // Update page numbers
    updatePageNumbers(page, pages);
}

function updatePageNumbers(currentPage, totalPages) {
    const pageNumbersContainer = document.querySelector('.page-numbers');
    pageNumbersContainer.innerHTML = '';
    
    // Calculate which page numbers to show
    let startPage = Math.max(1, currentPage - 2);
    let endPage = Math.min(totalPages, currentPage + 2);
    
    // Adjust if we're near the beginning or end
    if (endPage - startPage < 4) {
        if (startPage === 1) {
            endPage = Math.min(totalPages, startPage + 4);
        } else {
            startPage = Math.max(1, endPage - 4);
        }
    }
    
    // Add page numbers
    for (let i = startPage; i <= endPage; i++) {
        const pageBtn = document.createElement('button');
        pageBtn.className = `btn ${i === currentPage ? 'btn-primary' : 'btn-outline-secondary'}`;
        pageBtn.textContent = i;
        pageBtn.onclick = () => goToPage(i);
        pageNumbersContainer.appendChild(pageBtn);
    }
}

async function previousPage() {
    if (currentPage > 1) {
        currentPage--;
        await loadConversations();
    }
}

async function nextPage() {
    if (currentPage < totalPages) {
        currentPage++;
        await loadConversations();
    }
}

async function goToPage(page) {
    if (page >= 1 && page <= totalPages && page !== currentPage) {
        currentPage = page;
        await loadConversations();
    }
}

function closeModal(modalId) {
    document.getElementById(modalId).style.display = 'none';
}

function showLoadingState() {
    const tbody = document.getElementById('conversations-table-body');
    tbody.innerHTML = `
        <tr>
            <td colspan="7" class="text-center py-4">
                <div class="loading-spinner">
                    <i class="fas fa-spinner fa-spin fa-2x"></i>
                    <p class="mt-2">Loading conversations...</p>
                </div>
            </td>
        </tr>
    `;
}

function hideLoadingState() {
    // Loading state will be replaced by renderConversations
}

async function checkAndInitializeSampleData() {
    try {
        const stats = await conversationManager.getStats();
        if (stats.total === 0) {
            // No conversations exist, show option to initialize sample data
            const shouldInitialize = confirm(
                'No conversations found in the database. Would you like to initialize some sample data for demonstration purposes?'
            );
            
            if (shouldInitialize) {
                await conversationManager.initializeSampleData();
                await loadConversations();
            }
        }
    } catch (error) {
        console.error('Error checking sample data:', error);
        // Don't show error toast for this as it's not critical
    }
}

// Utility functions
function escapeHtml(text) {
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
}

function truncateText(text, maxLength) {
    if (text.length <= maxLength) return text;
    return text.substring(0, maxLength) + '...';
}

function showEditModal(conversation) {
    // Implementation for edit modal would go here
    // For now, just show an alert
    alert('Edit functionality would be implemented here. Conversation ID: ' + conversation._id);
}

function logout() {
    const authManager = new AuthManager();
    authManager.logout();
    window.location.href = '../index.html';
}

// Global functions for onclick handlers
window.showFilters = showFilters;
window.applyFilters = applyFilters;
window.clearFilters = clearFilters;
window.viewConversation = viewConversation;
window.escalateConversation = escalateConversation;
window.exportConversations = exportConversations;
window.previousPage = previousPage;
window.nextPage = nextPage;
window.closeModal = closeModal;
window.logout = logout;
    </script>
    <style>
        .sidebar-user-profile {
            position: absolute;
            bottom: 1.5rem;
            left: 1.5rem;
            right: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 1rem;
            background: rgba(59, 130, 246, 0.1);
            border-radius: 8px;
        }

        .sidebar-user-profile .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: #3b82f6;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 0.875rem;
        }

        .sidebar-user-profile .user-details {
            flex: 1;
        }

        .sidebar-user-profile .user-name {
            font-size: 0.875rem;
            font-weight: 500;
            color: white;
            margin: 0;
        }

        .sidebar-user-profile .user-role {
            font-size: 0.75rem;
            color: #93c5fd;
            margin: 0;
        }

        .header .user-info {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .header .user-details {
            display: flex;
            flex-direction: column;
        }

        .header .user-name {
            font-size: 0.875rem;
            font-weight: 500;
            color: #1e293b;
            margin: 0;
        }

        .header .user-role {
            font-size: 0.75rem;
            color: #64748b;
            margin: 0;
        }

        .header-actions {
            display: flex;
            gap: 0.75rem;
        }

        .filters-section {
            margin-bottom: 2rem;
        }

        .filter-actions {
            margin-top: 1rem;
            display: flex;
            gap: 0.75rem;
        }

        .user-info-cell {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .user-info-cell .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: #3b82f6;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 0.875rem;
        }

        .user-info-cell .user-details {
            display: flex;
            flex-direction: column;
        }

        .user-info-cell .user-name {
            font-size: 0.875rem;
            font-weight: 500;
            color: #1e293b;
            margin: 0;
        }

        .user-info-cell .user-email {
            font-size: 0.75rem;
            color: #64748b;
            margin: 0;
        }

        .message-preview, .response-preview {
            max-width: 200px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .date-info {
            display: flex;
            flex-direction: column;
        }

        .date-info .date {
            font-size: 0.875rem;
            font-weight: 500;
            color: #1e293b;
        }

        .date-info .time {
            font-size: 0.75rem;
            color: #64748b;
        }

        .sentiment-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.025em;
        }

        .sentiment-badge.positive {
            background: #dcfce7;
            color: #166534;
        }

        .sentiment-badge.neutral {
            background: #f1f5f9;
            color: #475569;
        }

        .sentiment-badge.negative {
            background: #fef2f2;
            color: #dc2626;
        }

        .pagination-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 2rem;
            padding: 1rem 0;
        }

        .pagination-info {
            font-size: 0.875rem;
            color: #64748b;
        }

        .pagination-controls {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .page-numbers {
            display: flex;
            gap: 0.25rem;
        }

        .page-numbers .btn {
            min-width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0;
        }

        .conversation-detail {
            max-height: 500px;
            overflow-y: auto;
        }

        .conversation-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #e2e8f0;
        }

        .conversation-header .user-info {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .conversation-header .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #3b82f6;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 1rem;
        }

        .conversation-header .user-details {
            display: flex;
            flex-direction: column;
        }

        .conversation-header .user-name {
            font-size: 1rem;
            font-weight: 600;
            color: #1e293b;
            margin: 0;
        }

        .conversation-header .user-email {
            font-size: 0.875rem;
            color: #64748b;
            margin: 0;
        }

        .conversation-meta {
            display: flex;
            gap: 0.5rem;
        }

        .conversation-messages {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .message {
            display: flex;
            gap: 0.75rem;
        }

        .message.user-message {
            justify-content: flex-end;
        }

        .message.bot-message {
            justify-content: flex-start;
        }

        .message-content {
            max-width: 70%;
            padding: 0.75rem 1rem;
            border-radius: 12px;
            position: relative;
        }

        .user-message .message-content {
            background: #3b82f6;
            color: white;
        }

        .bot-message .message-content {
            background: #f1f5f9;
            color: #1e293b;
        }

        .message-text {
            margin-bottom: 0.25rem;
            line-height: 1.5;
        }

        .message-time {
            font-size: 0.75rem;
            opacity: 0.7;
        }

        @media (max-width: 768px) {
            .header-actions {
                flex-direction: column;
            }

            .pagination-container {
                flex-direction: column;
                gap: 1rem;
            }

            .conversation-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }

            .message-content {
                max-width: 85%;
            }
        }
    </style>
</body>
</html>